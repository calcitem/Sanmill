{
  "network": {
    "input_channels": 17,
    "num_filters": 768,
    "num_residual_blocks": 20,
    "dropout_rate": 0.2
  },
  "mcts": {
    "num_mcts_sims": 25,
    "c_puct": 1.0,
    "add_dirichlet_noise": true,
    "dirichlet_alpha": 0.3,
    "dirichlet_epsilon": 0.25,
    "temperature_threshold": 10
  },
  "training": {
    "iterations": 100,
    "games_per_iteration": 100,
    "max_examples": 200000,
    "train_batch_size": 64,
    "train_epochs": 5,
    "train_lr": 0.001,
    "use_pretraining": true,
    "pretrain_positions": 50000,
    "pretrain_batch_size": 64,
    "pretrain_epochs": 10,
    "pretrain_lr": 0.001,
    "cuda": true,
    "self_play_workers": null,
    "checkpoint_dir": "checkpoints",
    "checkpoint_interval": 10
  },
  "perfect_db": {
    "perfect_db_path": null,
    "use_direct_perfect_db_training": true,
    "perfect_db_complete_enumeration": null,
    "trap_ratio": 0.3,
    "trap_weight": 2.0,
    "db_workers": 4,
    "db_cache_size": 10000,
    "db_batch_size": 1000,
    "phase_weights": {
      "placement": 0.45,
      "moving": 0.35,
      "flying": 0.2
    }
  },
  "preprocessed_training": {
    "data_dir": "",
    "max_positions": null,
    "trap_ratio": 0.3,
    "phase_filter": null,
    "epochs": 30,
    "batch_size": 256,
    "learning_rate": 0.0002,
    "policy_loss": "kld",
    "resume_from_checkpoint": true,
    "resume_checkpoint_path": null,
    "save_checkpoint_every_n_epochs": 2,
    "keep_n_checkpoints": 5,
    "save_per_chunk": true,
    "chunk_checkpoint_retention": 10,
    "full_dataset_traversal": true,
    "shuffle_data": true,
    "data_loading_workers": 12,
    "prefetch_factor": 4,
    "pin_memory": true,
    "gradient_accumulation_steps": 2,
    "mixed_precision": true,
    "compile_model": true,
    "cpu": false,
    "num_workers": 2,
    "checkpoint_dir": "checkpoints_preprocessed_hp",
    "memory_conservative": false,
    "high_performance": true,
    "force_small_dataset": false,
    "no_swap": true,
    "memory_threshold": 32.0,
    "chunked_training": true,
    "chunk_memory": 16.0,
    "fast_mode": false,
    "verbose": false,
    "metadata_debug": false,
    "scheduler": {
      "type": "reduce_on_plateau",
      "params": {
        "mode": "min",
        "factor": 0.5,
        "patience": 2,
        "threshold": 0.0005,
        "cooldown": 0,
        "min_lr": 1e-6
      }
    },
    "plateau_detection": {
      "window": 400,
      "min_history": 400,
      "rel_std_threshold": 0.004,
      "warmup_batches": 5000
    },
    "stability_detection": {
      "osc_min_history": 300,
      "osc_rel_std_threshold": 0.8,
      "osc_warmup_batches": 5000
    }
  }
}